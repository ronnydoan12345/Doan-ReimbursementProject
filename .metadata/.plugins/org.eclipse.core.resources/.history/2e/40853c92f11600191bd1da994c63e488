package org.revature.ERS.org.revature.ERS;

import java.io.IOException;
import java.sql.CallableStatement;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;

public class EmployeeDao {

//	public boolean checkTheUserName (String username)throws SQLException, IOException {
//		PreparedStatement ps = null;
//		boolean isUserName = false;
//		ArrayList<String> employeeUserNames = new ArrayList<String>();
//		
//		try {
//			DBUtilities dbUtilities = new DBUtilities();
//			
//			String sqlStatement = "SELECT email FROM Employee";
//			ps = dbUtilities.connection.prepareStatement(sqlStatement);
//			ResultSet resultSet = ps.executeQuery();
//			
//			while(resultSet.next()) {
//				
//				employeeUserNames.add(resultSet.getString("email"));
//				
//			}
//			
//			
//			
//			
//			
//			
//			
//		}catch(SQLException ex) {
//			
//		}
//		
//		
//	}

	public ArrayList<Employee> getAllEmployees() throws SQLException, IOException, ClassNotFoundException {

		PreparedStatement ps = null;
		Employee emp = null;
		ArrayList<Employee> employees = new ArrayList<Employee>();

		try {
			DBUtilities dbUtilities = new DBUtilities();

			String sqlStatement = "SELECT * FROM Employee";
			ps = dbUtilities.connection.prepareStatement(sqlStatement);
			ResultSet resultSet = ps.executeQuery();

			while (resultSet.next()) {

				emp = new Employee();
				emp.setId(resultSet.getInt("id"));
				emp.setFullname(resultSet.getString("fullname"));
				emp.setEmail(resultSet.getString("email"));
				emp.setPassword(resultSet.getString("password"));

				employees.add(emp);

			}
			dbUtilities.DisconnectFromDB();

		} catch (SQLException ex) {
			System.out.println("The following error has occured" + ex.getMessage());
		}
		return employees;

	}

	public void RegisterEmployee(String position,String fullname, String email, String password) throws SQLException, IOException, ClassNotFoundException {

		CallableStatement cs = null;

		try {
			DBUtilities dbUtilities = new DBUtilities();
			String sql = "{CALL RegisterEmployee(?, ?, ?, ?)}";
			cs = dbUtilities.connection.prepareCall(sql);
			System.out.println("got here");
			cs.setString(1, position);
			cs.setString(2, fullname);
			cs.setString(3, email);
			cs.setString(4, password);
			

			Boolean result = cs.execute(); // need this line to execute
			// returns false if true i know! crazy
			if (!result) {
				System.out.println("Employee updated in data base from DAO!");
				System.out.println();
			} else {
				// System.out.println("Failed to create account.");
			}

			cs.close();
			dbUtilities.connection.close();

		} catch (SQLException ex) {
			System.out.println("The following error has occured" + ex.getMessage());
		}

	}

}
